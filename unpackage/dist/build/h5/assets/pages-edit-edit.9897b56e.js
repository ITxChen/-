import{e,o as t,c as a,w as i,j as s,n as l,b as o,d as n,k as r,i as u,B as p,D as d,m as c,p as h,f as m,a as g,C as f,s as v,v as y,x as b,E as S,I as w,G as _,r as x,l as C}from"./index-071c8e17.js";import{_ as T}from"./_plugin-vue_export-helper.1b428a4d.js";import{r as k}from"./uni-app.es.af5b3bc2.js";import{a as B,b as $}from"./tool.6da0bed1.js";const I=T({name:"u-button",emits:["click","getphonenumber","getuserinfo","error","opensetting","launchapp","chooseavatar"],props:{hairLine:{type:Boolean,default:!0},type:{type:String,default:"default"},size:{type:String,default:"default"},shape:{type:String,default:"square"},plain:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},openType:{type:String,default:""},formType:{type:String,default:""},appParameter:{type:String,default:""},hoverStopPropagation:{type:Boolean,default:!1},lang:{type:String,default:"en"},sessionFrom:{type:String,default:""},sendMessageTitle:{type:String,default:""},sendMessagePath:{type:String,default:""},sendMessageImg:{type:String,default:""},showMessageCard:{type:Boolean,default:!1},hoverBgColor:{type:String,default:""},rippleBgColor:{type:String,default:""},ripple:{type:Boolean,default:!1},hoverClass:{type:String,default:""},customStyle:{type:Object,default:()=>({})},dataName:{type:String,default:""},throttleTime:{type:[String,Number],default:500},hoverStartTime:{type:[String,Number],default:20},hoverStayTime:{type:[String,Number],default:150},timerId:{type:[String,Number]}},computed:{getHoverClass(){if(this.loading||this.disabled||this.ripple||this.hoverClass)return"";let e="";return e=this.plain?"u-"+this.type+"-plain-hover":"u-"+this.type+"-hover",e},showHairLineBorder(){return["primary","success","error","warning"].indexOf(this.type)>=0&&!this.plain?"":"u-hairline-border"}},data(){return{btnTimerId:this.timerId||"button_"+Math.floor(1e8*Math.random()+0),rippleTop:0,rippleLeft:0,fields:{},waveActive:!1}},methods:{click(e){this.$u.throttle((()=>{!0!==this.loading&&!0!==this.disabled&&(this.ripple&&(this.waveActive=!1,this.$nextTick((function(){this.getWaveQuery(e)}))),this.$emit("click",e))}),this.throttleTime,!0,this.btnTimerId)},getWaveQuery(e){this.getElQuery().then((t=>{let a=t[0];if(!a.width||!a.width)return;if(a.targetWidth=a.height>a.width?a.height:a.width,!a.targetWidth)return;this.fields=a;let i="",s="";i=e.touches[0].clientX,s=e.touches[0].clientY,this.rippleTop=s-a.top-a.targetWidth/2,this.rippleLeft=i-a.left-a.targetWidth/2,this.$nextTick((()=>{this.waveActive=!0}))}))},getElQuery(){return new Promise((t=>{let a="";a=e().in(this),a.select(".u-btn").boundingClientRect(),a.exec((e=>{t(e)}))}))},getphonenumber(e){this.$emit("getphonenumber",e)},getuserinfo(e){this.$emit("getuserinfo",e)},error(e){this.$emit("error",e)},opensetting(e){this.$emit("opensetting",e)},launchapp(e){this.$emit("launchapp",e)},chooseavatar(e){this.$emit("chooseavatar",e)}}},[["render",function(e,d,c,h,m,g){const f=u,v=p;return t(),a(v,{id:"u-wave-btn",class:l(["u-btn u-line-1 u-fix-ios-appearance",["u-size-"+c.size,c.plain?"u-btn--"+c.type+"--plain":"",c.loading?"u-loading":"","circle"==c.shape?"u-round-circle":"",c.hairLine?g.showHairLineBorder:"u-btn--bold-border","u-btn--"+c.type,c.disabled?`u-btn--${c.type}--disabled`:""]]),"hover-start-time":Number(c.hoverStartTime),"hover-stay-time":Number(c.hoverStayTime),disabled:c.disabled,"form-type":c.formType,"open-type":c.openType,"app-parameter":c.appParameter,"hover-stop-propagation":c.hoverStopPropagation,"send-message-title":c.sendMessageTitle,"send-message-path":"sendMessagePath",lang:c.lang,"data-name":c.dataName,"session-from":c.sessionFrom,"send-message-img":c.sendMessageImg,"show-message-card":c.showMessageCard,onGetphonenumber:g.getphonenumber,onGetuserinfo:g.getuserinfo,onError:g.error,onOpensetting:g.opensetting,onLaunchapp:g.launchapp,onChooseavatar:g.chooseavatar,style:o([c.customStyle,{overflow:c.ripple?"hidden":"visible"}]),onClick:d[0]||(d[0]=r((e=>g.click(e)),["stop"])),"hover-class":g.getHoverClass,loading:c.loading},{default:i((()=>[s(e.$slots,"default",{},void 0,!0),c.ripple?(t(),a(f,{key:0,class:l(["u-wave-ripple",[m.waveActive?"u-wave-active":""]]),style:o({top:m.rippleTop+"px",left:m.rippleLeft+"px",width:m.fields.targetWidth+"px",height:m.fields.targetWidth+"px","background-color":c.rippleBgColor||"rgba(0, 0, 0, 0.15)"})},null,8,["class","style"])):n("",!0)])),_:3},8,["class","hover-start-time","hover-stay-time","disabled","form-type","open-type","app-parameter","hover-stop-propagation","send-message-title","lang","data-name","session-from","send-message-img","show-message-card","onGetphonenumber","onGetuserinfo","onError","onOpensetting","onLaunchapp","onChooseavatar","style","hover-class","loading"])}],["__scopeId","data-v-270e3a6c"]]),z=T({__name:"edit",setup(s){const o=d.database(),n=c(null);function r(){e().in(this).select(".myEdit").fields({size:!0,context:!0},(e=>{n.value=e.context})).exec()}const p=()=>{n.value.insertDivider()},T=c(!1),z=()=>{T.value=!T.value,n.value.format("header",!!T.value&&"H2")},M=c(!1),L=()=>{M.value=!M.value,n.value.format("bold")},P=c(!1),N=()=>{P.value=!P.value,n.value.format("italic")},W=()=>{f({success:async e=>{v({title:"上传中",mask:!0});for(let t of e.tempFiles)await d.uploadFile({filePath:t.path,cloudPath:t.name}).then((e=>{n.value.insertImage({src:e.fileID})}));y()}})},j=c({title:"",content:"",picurls:"",description:"",province:""}),E=()=>{n.value.getContents({success:e=>{j.value.description=e.text.slice(0,80),j.value.content=e.html,j.value.picurls=$(e.html),v({title:"发布中"}),G()}})},G=()=>{o.collection("quanzi_article").add({...j.value}).then((e=>{y(),b({title:"发布成功"}),setTimeout((()=>{S({url:"/pages/index/index"})}),800)}))};return h((()=>{B().then((e=>{j.value.province=e}))})),(e,s)=>{const o=w,n=u,d=_,c=k(x("u-button"),I),h=C;return t(),a(n,{class:"edit"},{default:i((()=>[m(n,{class:"title"},{default:i((()=>[m(o,{type:"text",placeholder:"请输入完整标题",modelValue:j.value.title,"onUpdate:modelValue":s[0]||(s[0]=e=>j.value.title=e)},null,8,["modelValue"])])),_:1}),m(n,{class:"content"},{default:i((()=>[m(d,{ref:"editorRef",placeholder:"写点什么吧~~",class:"myEdit","show-img-size":"","show-img-toolbar":"","show-img-resize":"",onReady:r,onStatuschange:e.onStatuschange},null,8,["onStatuschange"])])),_:1}),m(n,{class:"btnGroup"},{default:i((()=>[m(c,{type:"primary",disabled:!j.value.title.length,onClick:E},{default:i((()=>[g(" 确认发表 ")])),_:1},8,["disabled"])])),_:1}),m(n,{class:"tools"},{default:i((()=>[m(n,{class:"item"},{default:i((()=>[m(h,{class:l(["iconfont icon-zitibiaoti",T.value?"active":""]),onClick:z},null,8,["class"])])),_:1}),m(n,{class:"item"},{default:i((()=>[m(h,{class:l(["iconfont icon-zitijiacu",M.value?"active":""]),onClick:L},null,8,["class"])])),_:1}),m(n,{class:"item"},{default:i((()=>[m(h,{class:l(["iconfont icon-zitixieti",P.value?"active":""]),onClick:N},null,8,["class"])])),_:1}),m(n,{class:"item",onClick:p},{default:i((()=>[m(h,{class:"iconfont icon-fengexian"})])),_:1}),m(n,{class:"item",onClick:W},{default:i((()=>[m(h,{class:"iconfont icon-charutupian"})])),_:1}),m(n,{class:"item"},{default:i((()=>[m(h,{class:"iconfont icon-duigou_kuai"})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-181672cc"]]);export{z as default};
