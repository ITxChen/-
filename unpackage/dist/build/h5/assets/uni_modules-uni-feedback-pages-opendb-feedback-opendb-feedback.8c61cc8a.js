import{D as e,z as a,s as t,v as o,x as l,K as n,J as i,o as s,c as r,w as m,i as u,f,a as d,d as c,ah as p,r as b,B as h}from"./index-071c8e17.js";import{_}from"./uni-forms-item.43ba2202.js";import{r as g}from"./uni-app.es.af5b3bc2.js";import{v as k,_ as D}from"./opendb-feedback.c9f9ac16.js";import{_ as V}from"./uni-easyinput.06277378.js";import{_ as y}from"./uni-forms.4269e4f0.js";import{_ as v}from"./uni-fab.cb1777f2.js";import{_ as j}from"./_plugin-vue_export-helper.1b428a4d.js";import"./uni-icons.c3f4a5ee.js";console.log(k);const C=e.database();function x(e){let a={};for(let t in k)e.indexOf(t)>-1&&(a[t]=k[t]);return a}const O=j({data(){let e={content:"",imgs:[],contact:"",mobile:""};return{formData:e,formOptions:{},rules:{...x(Object.keys(e))}}},onReady(){this.$refs.form.setRules(this.rules)},methods:{fabClick(){a({url:"/uni_modules/uni-feedback/pages/opendb-feedback/list"})},submit(){t({mask:!0}),this.$refs.form.validate().then((e=>{this.submitForm(e)})).catch((()=>{o()}))},submitForm(e){C.collection("opendb-feedback").add(e).then((e=>{l({icon:"none",title:"提交成功"}),this.getOpenerEventChannel().emit("refreshData"),setTimeout((()=>n()),500)})).catch((e=>{i({content:e.message||"请求服务失败",showCancel:!1})})).finally((()=>{o()}))}}},[["render",function(e,a,t,o,l,n){const i=p,k=g(b("uni-forms-item"),_),j=g(b("uni-file-picker"),D),C=g(b("uni-easyinput"),V),x=h,O=u,U=g(b("uni-forms"),y),F=g(b("uni-fab"),v);return s(),r(O,{class:"uni-container"},{default:m((()=>[f(U,{ref:"form",value:l.formData,"validate-trigger":"submit","err-show-type":"toast"},{default:m((()=>[f(k,{name:"content",label:"留言内容/回复内容",required:""},{default:m((()=>[f(i,{onInput:a[0]||(a[0]=a=>e.binddata("content",a.detail.value)),class:"uni-textarea-border",modelValue:l.formData.content,"onUpdate:modelValue":a[1]||(a[1]=e=>l.formData.content=e),trim:"right"},null,8,["modelValue"])])),_:1}),f(k,{name:"imgs",label:"图片列表"},{default:m((()=>[f(j,{"file-mediatype":"image",limit:6,"return-type":"array",modelValue:l.formData.imgs,"onUpdate:modelValue":a[2]||(a[2]=e=>l.formData.imgs=e)},null,8,["modelValue"])])),_:1}),f(k,{name:"contact",label:"联系人"},{default:m((()=>[f(C,{modelValue:l.formData.contact,"onUpdate:modelValue":a[3]||(a[3]=e=>l.formData.contact=e),trim:"both"},null,8,["modelValue"])])),_:1}),f(k,{name:"mobile",label:"联系电话"},{default:m((()=>[f(C,{modelValue:l.formData.mobile,"onUpdate:modelValue":a[4]||(a[4]=e=>l.formData.mobile=e),trim:"both"},null,8,["modelValue"])])),_:1}),f(O,{class:"uni-button-group"},{default:m((()=>[f(x,{type:"primary",class:"uni-button",onClick:n.submit},{default:m((()=>[d("提交")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["value"]),e.uniIDHasRole("admin")?(s(),r(O,{key:0},{default:m((()=>[f(F,{ref:"fab",horizontal:"right",vertical:"bottom","pop-menu":!1,onFabClick:n.fabClick},null,8,["onFabClick"])])),_:1})):c("",!0)])),_:1})}],["__scopeId","data-v-923075a5"]]);export{O as default};
